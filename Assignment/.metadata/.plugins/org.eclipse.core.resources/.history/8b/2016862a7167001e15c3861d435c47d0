/*
 * timers.c
 *
 *  Created on: Oct 11, 2023
 *      Author: joshu
 */
#include "timers.h"

alt_alarm timer;

alt_u32 vp_light_timer_isr(void* context){
	IOWR_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE, (IORD_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE) & ~(1 << 0)));
	printf("APLEDExpired\r\n");
	return 0;
}

alt_u32 ap_light_timer_isr(void* context){
	IOWR_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE, (IORD_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE) & ~(1 << 1)));
	printf("APLEDExpired\r\n");
	return 0;
}



void vp_light_timer(){
	void* context = 0;

	IOWR_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE, (IORD_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE) | 1 << 0));
	printf("timer started");
	alt_alarm_start(&timer, LED_TIMEOUT, vp_light_timer_isr, context);

}

void ap_light_timer(){
	void* context = 0;

	IOWR_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE, (IORD_ALTERA_AVALON_PIO_DATA(LEDS_RED_BASE) | 1 << 1));
	printf("timer started");
	alt_alarm_start(&timer, LED_TIMEOUT, ap_light_timer_isr, context);

}

